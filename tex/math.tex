% tex/math.tex â€” Math symbols, operators, and shared notation
%
% NOTE: theorem/lemma/definition environments are defined in `tex/env.tex` to
% keep all environment configuration in a single place, aligned with the
% reference material under `tex/literature/`.

%==============================================================================
% MATH OPERATORS
%==============================================================================
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator{\sign}{sign}
\DeclareMathOperator{\Tr}{Tr}

%==============================================================================
% PROBABILITY AND STATISTICS
%==============================================================================
\newcommand{\E}{\mathbb{E}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\Cov}{\mathrm{Cov}}
\newcommand{\R}{\mathbb{R}}

%==============================================================================
% POLICY NOTATION
%==============================================================================
\newcommand{\piroll}{\pi_{\mathrm{roll}}}
\newcommand{\pitheta}{\pi_{\theta}}
% PPO-style implementations often denote the rollout snapshot as \piold. In this
% paper, the theoretical behavior/data-generating policy is always \piroll; we
% only mention \piold when mapping to implementation terminology.
\newcommand{\piold}{\pi_{\mathrm{old}}}
\newcommand{\piref}{\pi_{\mathrm{ref}}}
\newcommand{\ylt}{y_{<t}}
\newcommand{\yle}{y_{\le t}}

%==============================================================================
% IMPORTANCE RATIOS (TRM/GSPO STYLE)
%------------------------------------------------------------------------------
% We follow the reference style in `tex/literature/` and use:
% - token-level ratio: \rho_t
% - sequence-level geometric-mean ratio: \rhoseq
% - prefix-level geometric-mean ratio: \rhoprefix{t}
%==============================================================================
\newcommand{\rhoseq}{\rho^{\mathrm{seq}}}
\newcommand{\rhoprefix}[1]{\rho_{#1}^{\mathrm{pre}}}

%==============================================================================
% DIVERGENCE MEASURES (following TRM paper convention)
%==============================================================================
\newcommand{\DKL}{D_{\mathrm{KL}}}
\newcommand{\DTV}{D_{\mathrm{TV}}}
\newcommand{\Dkltok}{D_{\mathrm{KL}}^{\mathrm{tok}}}
\newcommand{\Dtvtok}{D_{\mathrm{TV}}^{\mathrm{tok}}}
\newcommand{\Dkltokmax}{D_{\mathrm{KL}}^{\mathrm{tok,max}}}
\newcommand{\Dtvtokmax}{D_{\mathrm{TV}}^{\mathrm{tok,max}}}
\newcommand{\Dklseq}{D_{\mathrm{KL}}^{\mathrm{seq}}}
\newcommand{\Dtvseq}{D_{\mathrm{TV}}^{\mathrm{seq}}}
\newcommand{\Dbar}{\bar{D}}

%==============================================================================
% COMMON MATH SHORTCUTS
%==============================================================================
\newcommand{\Ls}{\mathcal{L}}
\def\eps{{\epsilon}}
\newcommand{\epslow}{\epsilon_{\mathrm{low}}}
\newcommand{\epshigh}{\epsilon_{\mathrm{high}}}
\def\ceil#1{\lceil #1 \rceil}
\def\floor#1{\lfloor #1 \rfloor}
